<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% block title %}{% endblock %}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-SgOJa3DmI69IUzQ2PVdRZhwQ+dy64/BUtbMJw1MZ8t5HZApcHrRKUc4W0kG879m7" crossorigin="anonymous">
    <style>
      .editedPicture {
        margin: 50px 0;
        text-align: center;
      }
      .editedPicture img {
        width: 80%;
        max-width: 800px;
      }
    </style>
  </head>
  <body>
    <div class="container">
        {% block content %}            
        {% endblock %}
    </div>
    <script>
      if ('scrollRestoration' in history) {
        history.scrollRestoration = 'manual';
      }
    
      const pages = document.querySelectorAll('.editedPicture');
    
      let observer;
    
      function createObserver() {
        observer = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              const id = entry.target.id;
              const pageNum = id.replace('page-', '');
              history.replaceState(null, '', `/page/${pageNum}`);
            }
          });
        }, {
          root: null,
          rootMargin: '0px',
          threshold: 0.5
        });
    
        pages.forEach(page => observer.observe(page));
      }
    
      window.addEventListener('load', () => {
        const match = window.location.pathname.match(/\/page\/(\d+)/);
        let target;
    
        if (match) {
          const pageNum = match[1];
          target = document.getElementById(`page-${pageNum}`);
        } else {
          target = document.getElementById('page-1');
        }
    
        if (target) {
          target.scrollIntoView({ behavior: 'auto', block: 'start' });
    
          setTimeout(() => {
            createObserver();
          }, 200);
        }
      });
    </script>
    
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/js/bootstrap.bundle.min.js" integrity="sha384-k6d4wzSIapyDyv1kpU366/PK5hCdSbCRGRCMv+eplOQJWyd1fbcAu9OCUj5zNLiq" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/js/bootstrap.min.js" integrity="sha384-VQqxDN0EQCkWoxt/0vsQvZswzTHUVOImccYmSyhJTp7kGtPed0Qcx8rK9h9YEgx+" crossorigin="anonymous"></script>
  </body>
</html>